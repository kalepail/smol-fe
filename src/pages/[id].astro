---
import Smol from "../components/Smol.svelte";
import Layout from "../layouts/Layout.astro";

const id = Astro.params.id;
const data = id
	? await fetch(`${import.meta.env.PUBLIC_API_URL}/${id}`)
			.then(async (res) => {
				if (res.ok) return res.json();
				return null;
			})
	: null;
---

<Layout
	title={data?.do?.lyrics?.title}
	description={data?.do?.payload?.prompt}
	song_url=`${import.meta.env.PUBLIC_API_URL}/song/${data?.d1?.Song_1}.png`
	image_url=`${import.meta.env.PUBLIC_API_URL}/image/${id}.png`
>
	<Smol client:load id={id} data={data} />
</Layout>
